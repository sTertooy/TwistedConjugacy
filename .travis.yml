language: c

addons:
  apt_packages:
  - libgmp-dev
  - libreadline-dev
  - zlib1g-dev
  - pari-gp

env: 
- GAPBRANCH=master GAP-BOOTSTRAP=full GAP_PKGS_TO_CLONE="autpgrp alnuth polycyclic"
- GAPBRANCH=master GAP-BOOTSTRAP=minimal GAP_PKGS_TO_CLONE="autpgrp alnuth polycyclic"
- GAPBRANCH=stable-4.11 GAP-BOOTSTRAP=full
- GAPBRANCH=stable-4.11 GAP-BOOTSTRAP=minimal
- GAPBRANCH=stable-4.11 GAP-BOOTSTRAP=full
- GAPBRANCH=stable-4.10 GAP-BOOTSTRAP=minimal

branches:
  only:
    - dev
    - master

before_script:
  - git clone https://github.com/gap-system/pkg-ci-scripts.git scripts
  - scripts/build_gap.sh

script:
  - scripts/build_pkg.sh && scripts/run_tests.sh

after_script:
  - scripts/gather-coverage.sh
  - bash <(curl -s https://codecov.io/bash)
